\documentclass[10pt]{article}
\usepackage[fontsize=10pt]{fontsize}

\usepackage[margin=0.5in]{geometry} 
\usepackage{amsmath,amsthm,amssymb, graphicx, multicol, array, txfonts}
\usepackage{bbm}

\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\setcounter{secnumdepth}{0}
\setlength\parindent{0pt}

 
\newenvironment{problem}[2][Problem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}

\newenvironment{prelim}[2][Preliminaries]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2}]}{\end{trivlist}}
    
\begin{document}
 
\title{6.S091 Problem Set 1}
\author{Suyeol Yun\\
6.S091: Causality}
\maketitle
 
\section{Preliminaries}
\subsection{(a)} 
\begin{align*}
\mathbb{P}_{\mathcal{X}} &= P(U)P(A|U)P(M|A)P(Y|M, U) \\
&= \operatorname{Ber}(0.5) \operatorname{Ber}(U/4) \operatorname{Ber}(0.5 + 0.1A)\operatorname{Ber}(M/2 + U/4)
\end{align*}

\subsection{(b)} 
\begin{align*}
&\mathbb{P}_{\mathcal{X}}(Y=1) = 0.38125\\
&\mathbb{P}_{\mathcal{X}}(Y=1 \mid M=0, A=0)= 0.10714285714285714\\
&\mathbb{P}_{\mathcal{X}}(Y=1 \mid M=0, A=1)= 0.25\\
\end{align*}


% \begin{align*}
%     P(Y|M=0, A=0) &= \mathbbm{1}_{\left\{\varepsilon_y+U / 4 \geq 1\right\}} \sim \operatorname{Ber}(U/4)\\
%     P(Y=1|M=0, A=0) &= P(Y=1|M=0, A=0, U=0)P(U=0) \\ &+ P(Y=1|M=0, A=0, U=1)P(U=1)\\
%     &= 0 \cdot 1/2 + 1/4 \cdot 1/2\\
%     &= 1/8\\
%     P(Y=1|M=0, A=1) &= P(Y=1|M=0, A=0)\\
%     &= 1/8
% \end{align*}


% % Since $U, A, M, Y$ are all have a set of alphabets $\{0, 1\}$, they follows Bernoulli distribution.
% % Then remaining task is to find the parameter of Bernoulli distribution for each variable.
% \begin{align*}
% \end{align*}


% \begin{align*}
%     \mathbb{P}(A=1) &=\sum_{U \in \{0,1\}}\mathbb{P}(A=1|U)P(U) && (\text{Law of Total Probability})\\
%     &=\sum_{U \in \{0,1\}}\mathbb{P}(\epsilon_a+U/4\ge1)P(U) \\
%     &=\sum_{U \in \{0,1\}}\mathbb{P}(\epsilon_a\ge1-U/4)P(U) \\
%     &=\mathbb{P}(\epsilon_a\ge 3/4)P(U=1) + \mathbb{P}(\epsilon_a\ge 1)P(U=0) \\
%     &=1/4\cdot1/2 + 0\cdot 1/2\\
%     &=1/8
% \end{align*}

% \begin{align*}
%     \mathbb{P}(M=1) &=\sum_{A \in \{0,1\}}\mathbb{P}(M=1|A)P(A) && (\text{Law of Total Probability})\\
%     &=\sum_{A \in \{0,1\}}\mathbb{P}(\varepsilon_m+10(1-A) \leq 60)P(A) \\
%     &=\sum_{A \in \{0,1\}}\mathbb{P}(\varepsilon_m \leq 60-10(1-A))P(A) \\
%     &=\mathbb{P}(\varepsilon_m \leq 60)P(A=1) + \mathbb{P}(\varepsilon_m \leq 50)P(A=0) \\
%     &=3/5\cdot1/8 + 1/2\cdot7/8\\
%     &=41/80
% \end{align*}

% \begin{align*}
%     \mathbb{P}(Y=1) &=\sum_{M \times U \in \{0,1\} \times \{0,1 \}} \mathbb{P}(Y=1|M, U)P(M, U) && (\text{Law of Total Probability})\\
%     &=\sum_{M \times U \in \{0,1\} \times \{0,1 \}} \mathbb{P}(Y=1|M, U)P(M|U)P(U)\\
%     &=\sum_{M \in \{0,1\}} \mathbb{P}(Y=1|M, U=0)P(M|U=0)P(U=0) \\ &+ \sum_{M \in \{0,1\}} \mathbb{P}(Y=1|M, U=1)P(M|U=1)P(U=1)\\
%     &=\mathbb{P}(Y=1|M=0, U=0)P(M=0|U=0)\cdot 1/2 \\& + \mathbb{P}(Y=1|M=1, U=0)P(M=1|U=0)\cdot 1/2 \\ &+ \mathbb{P}(Y=1|M=0, U=1)P(M=0|U=1)\cdot 1/2 \\ &+\mathbb{P}(Y=1|M=1, U=1)P(M=1|U=1)\cdot 1/2\\
%     &=0\cdot 41/80 \cdot 1/2 \\
%     & + 1/2 \cdot 39/80 \cdot 1/2 \\ 
%     &+ 1/4 \cdot 39/80 \cdot 1/2 \\ 
%     &+ 3/4 \cdot 41/80 \cdot 1/2\\
%     &=3/8
% \end{align*}

% In the above calculation, it's worth noting that $U$ nad $M$ are correlated via $A$, i.e. $U \rightarrow A \rightarrow M$. $M$ and $U$ are not independent and thus, $P(M|U)$ is computed as follows.

% \begin{align*}
%     P(M=0|U=0) &=  P(M=0, A=0|U=0)P(A=0|U=0) + P(M=0, A=1|U=0)P(A=1|U=0) \\
%     &=1/2 \cdot 7/8 + 3/5 \cdot 1/8 \\
%     &=41/80\\
% P(M=1|U=0) &= 1- 41/80 = 39/80 && \\
% P(M=0|U=1) &=  P(M=0|U=1, A=0)P(A=0) + P(M=0|U=1, A=1)P(A=1) \\
% &=1/2 \cdot 7/8 + 2/5 \cdot 1/8 \\
% &=39/80\\
% P(M=1|U=1) &=  41/80 \\
% \end{align*}

% \begin{align*}
%     P(M=0|U=0) &=  P(M=0|U=0, A=0)P(A=0) + P(M=0|U=0, A=1)P(A=1) \\
%     &=1/2 \cdot 7/8 + 3/5 \cdot 1/8 \\
%     &=41/80\\
% P(M=1|U=0) &= 1- 41/80 = 39/80 && \\
% P(M=0|U=1) &=  P(M=0|U=1, A=0)P(A=0) + P(M=0|U=1, A=1)P(A=1) \\
% &=1/2 \cdot 7/8 + 2/5 \cdot 1/8 \\
% &=39/80\\
% P(M=1|U=1) &=  41/80 \\
% \end{align*}

\section{Interventional}
\subsection{(c)}

\begin{align*}
\mathbb{P}_{\mathcal{X}}(U, A^I=1, M, Y \mid \operatorname{do}(A=1)) &=  P(U)P(M|A=1)P(Y|M, U, A=1)\\
&= \operatorname{Ber}(0.5)\cdot\operatorname{Ber}(0.6)\cdot\operatorname{Ber}(M/2 + U/4)\\
&= \operatorname{Ber}(0.5)\cdot\operatorname{Ber}(0.6)\cdot\operatorname{Ber}(M/2 + U/4)
\end{align*}    

\begin{align*}
    \mathbb{P}_{\mathcal{X}}(U, A^I=1, M, Y \mid \operatorname{do}(A=0)) &=  P(U)P(M|A=0)P(Y|M, U, A=0)\\
    &= \operatorname{Ber}(0.5)\cdot\operatorname{Ber}(0.5)\cdot\operatorname{Ber}(M/2 + U/4)\\
    &= \operatorname{Ber}(0.5)\cdot\operatorname{Ber}(0.5)\cdot\operatorname{Ber}(M/2 + U/4)
    \end{align*}    
    

\subsection{(d)}
% \begin{align*}
%     \mathbb{P}_{\mathcal{X}}(Y=1 \mid \text { do }(A=1))  &=\sum_{M \times U \in \{0,1\} \times \{0,1 \}} \mathbb{P}(Y=1|\text { do }(A=1), M, U)P(M, U|\text { do }(A=1)) \\
%     &=\sum_{M \times U \in \{0,1\} \times \{0,1 \}} \mathbb{P}(Y=1|\text { do }(A=1), M, U)P(M|\text { do }(A=1))P(U|\text { do }(A=1))\\
%     &=\mathbb{P}(Y=1|\text { do }(A=1), M=0, U=0)P(M=0|\text { do }(A=1))P(M|\text { do }(A=1))P(U=0|\text { do }(A=1))
%     \\& + \mathbb{P}(Y=1|\text { do }(A=1), M=1, U=0)P(M=1|\text { do }(A=1))P(M|\text { do }(A=1))P(U=0|\text { do }(A=1)) 
%     \\&+ \mathbb{P}(Y=1|\text { do }(A=1), M=0, U=1)P(M=0|\text { do }(A=1))P(M|\text { do }(A=1))P(U=1|\text { do }(A=1))
%     \\&+\mathbb{P}(Y=1|\text { do }(A=1), M=1, U=1)P(M=1|\text { do }(A=1))P(M|\text { do }(A=1))P(U=1|\text { do }(A=1))\\
%     &=0\cdot 2/5\cdot 0 + 1/2 \cdot 3/5\cdot 0  + 1/4 \cdot 2/5\cdot 1 + 0.75 \cdot 3/5\cdot 1\\
%     &=11/20\\
%     &=0.55\\
%     \mathbb{P}_{\mathcal{X}}(Y=0 \mid \text { do }(A=1)) &= 1-0.55 = 0.45
% \end{align*}

% \begin{align*}
%     \mathbb{P}_{\mathcal{X}}(Y=1 \mid \text { do }(A=0))  &=\sum_{M \times U \in \{0,1\} \times \{0,1 \}} \mathbb{P}(Y=1|\text { do }(A=0), M, U)P(M, U|\text { do }(A=0)) \\
%     &=\sum_{M \times U \in \{0,1\} \times \{0,1 \}} \mathbb{P}(Y=1|\text { do }(A=0), M, U)P(M|\text { do }(A=0))P(U|\text { do }(A=0))\\
%     &=\mathbb{P}(Y=1|\text { do }(A=0), M=0, U=0)P(M=0|\text { do }(A=0))\cdot P(U=0|\text { do }(A=0)) 
%     \\& + \mathbb{P}(Y=1|\text { do }(A=0), M=1, U=0)P(M=1|\text { do }(A=0))\cdot P(U=0|\text { do }(A=0)) 
%     \\&+ \mathbb{P}(Y=1|\text { do }(A=0), M=0, U=1)P(M=0|\text { do }(A=0))\cdot P(U=1|\text { do }(A=0)) 
%     \\&+\mathbb{P}(Y=1|\text { do }(A=0), M=1, U=1)P(M=1|\text { do }(A=0))\cdot P(U=1|\text { do }(A=0))\\
%     &=0\cdot 1/2\cdot 4/7 + 1/2 \cdot 1/2\cdot 4/7  + 1/4 \cdot 1/2\cdot 3/7 + 0.75 \cdot 1/2\cdot 3/7\\
%     &=5/14\\
%     \mathbb{P}_{\mathcal{X}}(Y=0 \mid \text { do }(A=0)) &= 1- 5/14 = 9/14
% \end{align*}
\begin{equation}
    \mathbb{P}_{\mathcal{X}}(Y \mid \operatorname{do}(A=1))=
    \begin{cases}
        0.425 & \text{if $Y=1$} \\
        0.575 & \text{if $Y=0$}
    \end{cases}
  \end{equation}

  \begin{equation}
    \mathbb{P}_{\mathcal{X}}(Y \mid \operatorname{do}(A=0))=
    \begin{cases}
        0.375 & \text{if $Y=1$} \\
        0.625 & \text{if $Y=0$}
    \end{cases}
  \end{equation}

\subsection{(e)}
If $A=1, U=0$, $P(A=1, U=0)=0$.  Therefore, $P(Y|A=1, U=0)$ is undefined. So I check only for the case of $do(A=0)$ which doesn't involve $P(Y|A=1, U=0)$ as a component in its process of computation. \\
\begin{align*}
    \mathbb{P}_{\mathcal{X}}(Y=1 \mid \operatorname{do}(A=0))&=0.375\\
    \sum_{u \in\{0,1\}} \mathbb{P}_{\mathcal{X}}(Y=1 \mid A=0, U=u) \mathbb{P}_{\mathcal{X}}(U=u)&=\mathbb{P}_{\mathcal{X}}(Y=1 \mid A=0, U=1) \mathbb{P}_{\mathcal{X}}(U=1) + \mathbb{P}_{\mathcal{X}}(Y=1 \mid A=0, U=0) \mathbb{P}_{\mathcal{X}}(U=0)\\
    &= 0.5 * 1/2 + 0.25 * 1/2\\
    &= 0.375 \text{\quad (match)}
\end{align*}

\begin{align*}
    \mathbb{P}_{\mathcal{X}}(Y=0 \mid \operatorname{do}(A=0))&=0.625\\
    \sum_{u \in\{0,1\}} \mathbb{P}_{\mathcal{X}}(Y=0 \mid A=0, U=u) \mathbb{P}_{\mathcal{X}}(U=u)&=\mathbb{P}_{\mathcal{X}}(Y=0 \mid A=0, U=1) \mathbb{P}_{\mathcal{X}}(U=1) + \mathbb{P}_{\mathcal{X}}(Y=0 \mid A=0, U=0) \mathbb{P}_{\mathcal{X}}(U=0)\\
    &= 0.5 * 1/2 + 0.75 * 1/2\\
    &= 0.625 \text{\quad (match)}
\end{align*}

\subsection{(f)}

\begin{align*}
    % \mathbb{P}_{\mathcal{X}}(Y \mid \operatorname{do}(A=1))&=0.425\\
    &\sum_{m \in\{0,1\}} \mathbb{P}_{\mathcal{X}}(M=m \mid A=0) \sum_{a^{\prime} \in\{0,1\}}\left(\mathbb{P}_{\mathcal{X}}\left(Y \mid M=m, A=a^{\prime}\right) \mathbb{P}_{\mathcal{X}}\left(A=a^{\prime}\right)\right)\\
    &=
\end{align*}

\section{Problem 2}

\subsection{(a)}
(Ask whether we start from $\mathbf{V}=\overline{\operatorname{an}}_{\mathcal{G}}(\mathbf{A} \cup \mathbf{B} \cup \mathbf{S})$)
By the setting, $\mathbf{V}=\overline{\operatorname{an}}_{\mathcal{G}}(\mathbf{A} \cup \mathbf{B} \cup \mathbf{S})$. 
Since $\gamma$ is d-connecting path, all nodes in $\gamma$ are unblocked. 
For a node to be unblocked, either 1) it is not collider and not in $S$ or 2) it is collider but it is not in $S$ and so is its decendents.
In both cases, the node is not in $\mathbf{S}$. In addition, since the definition of path doesn't include starting and end point which are in $A$ and $B$ respectively, we can exlcude the self $A\cup B\cup S$ from $V$, i.e.   $\mathbf{V}=\operatorname{an}_{\mathcal{G}}(\mathbf{A} \cup \mathbf{B} \cup \mathbf{S})_\blacksquare$ 

\subsection{(b)}

Since there exists a d-connecting path $\gamma$, 
$(\mathbf{A}, \mathbf{B}, \mathbf{S}) \notin \mathcal{I}_{\Perp}(\mathcal{G})$.
Since all nodes in $\gamma$ doesn't include any node in $S$ as shown in $(a)$, we can use $\gamma$ as a path in $\overline{\mathcal{G}[\mathbf{V}]}$ from $A$ to $B$ which doesn't pass through $S$ by replacing the directed edges to undirected ones.

\section{Problem 3}

\subsection{(a)}
\begin{align*}
    \mathbb{P}_{\mathcal{X}}(Y=1 \mid A=N) &= \sum_{S \in \{L, R\}}\mathbb{P}_{\mathcal{X}}(Y=1 \mid S, A=N) \mathbb{P}_{\mathcal{X}}(S)\\   
    &= 0.73 \cdot 0.49 + 0.93 \cdot  0.51 \\
    &= 0.832\\
    \mathbb{P}_{\mathcal{X}}(Y=1 \mid A=O) &= \sum_{S \in \{L, R\}}\mathbb{P}_{\mathcal{X}}(Y=1 \mid S, A=O) \mathbb{P}_{\mathcal{X}}(S)\\   
    &= 0.69 \cdot 0.49 + 0.87 \cdot  0.51 \\
    &= 0.7818
\end{align*}

\subsection{(b)}
(Ask how to draw $\zeta^I$)
Since $S$ satisfies backdoor criterion,  we can say 

$\mathbb{P}_{\mathcal{X}}(Y=1 \mid \operatorname{do}(A=N)) = \sum_{\mathbf{s}} \mathbb{P}_{\mathcal{X}}(Y \mid A=N, \mathbf{S}=\mathbf{s}) \mathbb{P}_{\mathcal{X}}(\mathbf{S}=\mathbf{s})=0.832$ and 
$\mathbb{P}_{\mathcal{X}}(Y=1 \mid \operatorname{do}(A=O)) = \sum_{\mathbf{s}} \mathbb{P}_{\mathcal{X}}(Y \mid A=O, \mathbf{S}=\mathbf{s}) \mathbb{P}_{\mathcal{X}}(\mathbf{S}=\mathbf{s})=0.7818$.

\section{Problem 4}

\begin{center}
    \begin{tabular}{||c c c c||} 
     \hline
     $\beta_{aw}$ & $\hat{\beta}_{aw}$ & $\hat{\beta}_{yw}$ & $\widehat{\beta}_{y w} / \widehat{\beta}_{a w}$ \\ [0.5ex] 
     \hline\hline
     5 & 4.52 & 33.84 & 7.47 \\ 
     \hline
     0.5 & 0.72 & 5.54 & 7.60 \\
     \hline
     0.05 & 0.32 & 2.49 & 7.62 \\
     \hline
    \end{tabular}
\end{center}

% $\beta_{aw}: 5, b_wa_hat: 4.527291388797304, b_wy_hat: 33.847991586594546, ratio: 7.476433187037785,  b_ay: 7.5, error:0.0031422417282952844
% b_wa: 0.5, b_wa_hat: 0.7290866735076191, b_wy_hat: 5.542779314016848, ratio: 7.602359932531293,  b_ay: 7.5, error:0.013647991004172392
% b_wa: 0.05, b_wa_hat: 0.32646743951621543, b_wy_hat: 2.490756958589264, ratio: 7.62941922257319,  b_ay: 7.5, error:0.017255896343091947$

\end{document}