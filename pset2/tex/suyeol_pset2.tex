\documentclass[10pt]{article}
\usepackage[fontsize=10pt]{fontsize}

\usepackage[margin=0.5in]{geometry} 
\usepackage{amsmath,amsthm,amssymb, graphicx, multicol, array, txfonts}
\usepackage{bbm}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan,
    pdftitle={Overleaf Example},
    pdfpagemode=FullScreen,
    }

\urlstyle{same}


\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\setcounter{secnumdepth}{0}
\setlength\parindent{0pt}

 
\newenvironment{problem}[2][Problem]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2.}]}{\end{trivlist}}

\newenvironment{prelim}[2][Preliminaries]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}\hskip \labelsep {\bfseries #2}]}{\end{trivlist}}
    
\begin{document}
 
\title{6.S091 Problem Set 2}
\author{Suyeol Yun\\
6.S091: Causality}
\maketitle
 
\section{Problem 1}
* Code is available here \url{https://github.com/syyunn/6.S091/blob/main/pset2/code/problem1/problem1.py}

\subsection{Plotting Regression Residuals [1 point]}
\subsection{(a)} $\hat{\beta}_{12} = 2.0032613606359835$
\subsection{(b)} $\hat{\beta}_{21} = 0.4853818665988653$

\includegraphics{images/problem1.png}

\subsection{Causal Direction Inference [1 point]}

\subsection{(c)}
The plot explains the relationship between $\varepsilon_1$ and $\varepsilon_2$. Since $\varepsilon_1 \Perp \varepsilon_2$, we have to choose the SCM which shows such independence. Therefore, the data is more likely to be generated from SCM $M^a$.

\section{Problem 2}

* Code is available here \url{https://github.com/syyunn/6.S091/blob/main/pset2/code/problem2/problem2.py}

\subsection{Partial correlation [2 points]}
\subsection{(a)}
$\hat{\rho}\left(X_1, X_4, \varnothing\right) = 0.18515108160562416$

\subsection{(b)}
$\hat{\rho}\left(X_1, X_4, \{X_2, X_3\}\right) = 0.0093340865561515$

\subsection{Fisherâ€™s z-transformation [1 point]}
\subsection{(c)}
$\hat{z}\left(X_1, X_4, \{X_2, X_3\}\right) = 0.9332023767104407$

\subsection{p-values [1 point]}
\subsection{(d)}
$\text { compute\_pvalue (pcalg\_samples, } 1,4,[2,3] \text { ) } = 0.35071548783635986$

\subsection{Skeleton phase [2 points]}
\subsection*{(e)}
$\text { pcalg\_skeleton(samples}[: 500], 0.2) = 11$

\includegraphics{images/skel_0.2.png}

\subsection*{(f)}
$\text { pcalg\_skeleton(samples}[: 500], 0.001) = 9$

\includegraphics{images/skel_0.001.png}

\subsection{Orientation phase [2 points]}
\subsection*{(g)}
$X_1 \rightarrow X_3 \leftarrow X_2$ is the only unshileded collider in the output of $\textit{pcalg\_orient(estimated\_skeleton, estimated\_separator\_function) }$. 

\subsection*{(h)}

The orientations $X_3 \rightarrow X_4, X_3 \rightarrow X_5, X_3 \rightarrow X_6, X_3 \rightarrow X_7$ are added by the Meek's rule \#1 (no extra unshileded colliders).
However, after the application of Rule 1, no other edges are oriented by the Rule 2, 3, and 4. See the details in the code.

\end{document}
